CREATE DATABASE IF NOT EXISTS fiestalandia;
USE fiestalandia;

-- Tabla: Usuario
CREATE TABLE Usuario (
    id_usuario INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    contrase√±a VARCHAR(255) NOT NULL,
    telefono VARCHAR(20)
);

-- Tabla: Categoria
CREATE TABLE Categoria (
    id_categoria INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL,
    descripcion TEXT,
    imagen_url VARCHAR(255)
);

-- Tabla: Proveedor
CREATE TABLE Proveedor (
    id_proveedor INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    contacto VARCHAR(100),
    direccion TEXT
);

-- Tabla: Producto
CREATE TABLE Producto (
    id_producto INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    descripcion TEXT,
    precio DECIMAL(10,2) NOT NULL,
    imagen_url VARCHAR(255),
    id_categoria INT,
    id_proveedor INT,
    FOREIGN KEY (id_categoria) REFERENCES Categoria(id_categoria)
        ON DELETE SET NULL ON UPDATE CASCADE,
    FOREIGN KEY (id_proveedor) REFERENCES Proveedor(id_proveedor)
        ON DELETE SET NULL ON UPDATE CASCADE
);

-- Tabla: Carrito
CREATE TABLE carrito (
  id_carrito INT NOT NULL AUTO_INCREMENT,
  id_usuario INT,
  fecha_creado DATETIME DEFAULT CURRENT_TIMESTAMP,
  metodo_pago ENUM('credito', 'debito', 'efectivo'),
  estatus ENUM('pendiente', 'pagado', 'cancelado') DEFAULT 'pendiente',
  fecha_pago DATETIME,
  cuotas_credito INT,
  intervalo_cuotas VARCHAR(20),
  PRIMARY KEY (id_carrito),
  FOREIGN KEY (id_usuario) REFERENCES usuario(id_usuario)
    ON DELETE CASCADE
    ON UPDATE CASCADE
);


-- Tabla: Carrito_Detalle
CREATE TABLE carrito_detalle (
  id_detalle INT NOT NULL AUTO_INCREMENT,
  id_carrito INT,
  id_producto INT,
  cantidad INT NOT NULL,
  total DECIMAL(10,2) DEFAULT 0.00,
  PRIMARY KEY (id_detalle),
  FOREIGN KEY (id_carrito) REFERENCES carrito(id_carrito)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  FOREIGN KEY (id_producto) REFERENCES producto(id_producto)
    ON DELETE CASCADE
    ON UPDATE CASCADE
);